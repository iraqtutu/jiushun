# 玖顺农机售后服务工单系统 - 需求规格说明书 (PRD) v1.2

## 1. 项目概述

### 1.1 项目背景
玖顺农机目前采用传统的纸质工单进行售后服务记录，存在数据录入繁琐、查询困难、不易统计和归档等问题。为了提高售后服务效率，实现数据的数字化管理，计划开发一套基于微信小程序的电子工单系统。

### 1.2 项目目标
- **无纸化办公**：将线下纸质填写流程完全迁移至线上。
- **数据规范化**：通过下拉菜单、必填项校验等手段，规范填写内容，减少错误。
- **提升效率**：自动生成单号，支持图片上传和自动识别，减少人工录入成本。
- **追溯与管理**：实现工单的数字化存储，便于后续查询、审核。
- **灵活授权**：支持用户自主申请账号，管理员审核，减轻初始录入工作量。

### 1.3 技术平台
- **前端**：UniApp (发布为微信小程序)
- **后端**：uniCloud (阿里云)

---

## 2. 用户角色与权限

| 角色 | 描述 | 核心权限 |
| :--- | :--- | :--- |
| **系统管理员** | 厂家内部管理人员 | 登录、查看所有工单、**审批账号申请** |
| **玖顺员工** | 厂家内部技术人员 | 登录、新建工单、查看所有/指定工单 |
| **经销商人员** | 代理销售及服务的合作伙伴 | 登录、新建工单、查看自己提交的工单 |
| **服务人员** | 一线维修与售后人员 | 登录、新建工单、查看自己提交的工单 |
| **待审核用户** | 已提交申请但未获批的用户 | 仅能查看申请状态或重新提交 |

---

## 3. 功能需求详情

### 3.1 用户登录系统
- **登录方式**：微信登录。
- **权限校验流程**：
  1. 若账号存在且状态为“启用”，进入系统首页。
  2. 若账号不存在或未授权，提示用户“账号不存在或未授权，请前往申请”。
  3. 提供“账号申请”入口链接。

### 3.2 账号申请与审批 (新增)

#### 3.2.1 账号申请 (前端)
无权限用户可进入申请页面，提交以下信息：
- **姓名**：必填，文本。
- **手机号**：必填，数字（自动填入或手动输入，需短信验证码验证身份为佳，视预算而定，此处暂定手动输入校验）。
- **用户类型**：必填，下拉选择（玖顺员工 / 经销商人员 / 服务人员）。
- **申请理由**：必填，多行文本（例如：我是XX地区经销商王某某）。

*提交后显示“申请已提交，等待管理员审核中”状态页。*

#### 3.2.2 账号审批 (管理员功能)
拥有管理员权限的用户（如特定玖顺员工）可访问“成员管理”模块：
- **待办列表**：展示所有状态为“待审核”的申请记录。
- **审批操作**：
  - **通过**：账号状态更为“启用”，用户可正常登录。
  - **拒绝**：需填写拒绝理由，账号状态更为“拒绝”。

### 3.3 派工单管理 (核心业务)

#### 3.3.1 新建派工单
用户点击“新建工单”进入填写页面，页面应包含以下模块：

**A. 基础信息**
- **派工单号**：系统自动生成，需保证唯一性（规则建议：`JS` + `年月日` + `流水号`，例如 `JS202601150001`）。
- **填单人**：自动读取当前登录用户姓名/ID。

**B. 客户资料**
- **姓名**：必填，文本输入。
- **联系电话**：必填，数字键盘，需校验格式。
- **地址**：必填，文本输入（可选支持地图定位选择）。
- **农机用途**：必填，单选（自用 / 作业）。
- **经销商名称**：关联信息，支持输入或选择。
- **报修时间**：默认当前时间，可修改。

**C. 产品信息**
- **机器编号**：必填，文本输入。
- **发动机号**：必填，文本输入。
- **铭牌照片**：**必填**，支持拍照或从相册上传。
- **生产日期**：必填，日期选择器。
- **产品型号**：
  - **交互方式**：支持手动选择（下拉菜单）与 自动识别（OCR）结合。
  - **逻辑**：用户上传铭牌照片后，系统尝试识别型号填入；用户也可直接通过下拉菜单选择并手动修正。

**D. 服务内容**
- **服务类型**：必填，单选/下拉（三包、维修、保养、技改、其他）。
- **故障信息分类**：必填，下拉菜单（发动机、液压系统、行走传动系统、电气系统、插值系统、其他）。
- **故障与处理**：
  - **故障现象**：多行文本框，描述故障具体表现。
  - **处理方法**：多行文本框，描述维修过程和结果。
- **零件信息**：
  - **更换零件**：支持添加多条记录。每条记录包含：零件名称、图号、数量。
  - **旧件处理**：单选（带回 / 丢弃）。
- **其他信息**：
  - **维修完成时间**：日期时间选择器。
  - **现场照片**：支持上传多张照片（需设定最小/最大上传数量，如 1-5 张）。

**E. 客户确认**
- **人机合影**：**必填**。需上传客户与修复后机器的合影，作为服务完成的凭证。
- **提交确认**：提交前需弹出确认框，提示“提交后将无法修改”。

**F. 草稿自动保存 (新增)**
- **自动缓存**：用户在填写过程中，系统需实时或定时将已填写内容缓存在本地（Storage）。
- **断点续传**：若用户中途退出小程序或因意外关闭，下次进入“新建工单”页面时，需检测是否存在未提交的草稿。
  - 若存在，提示用户“是否恢复上次未提交的草稿？”。
  - 用户确认后，自动填充之前填写的数据。
  - 提交成功后，自动清除本地草稿缓存。

未提交的工单自动缓存为草稿，临时未提交的工单可以在下次进入小程序后继续编辑。

#### 3.3.2 我的工单 (列表与详情)
- **列表展示**：
  - 展示关键信息：单号、客户姓名、服务类型、提交时间。
  - 支持下拉刷新、上拉加载更多。
- **详情查看**：
  - 点击列表项进入详情页。
  - 展示所有填写的字段及图片。
  - **只读限制**：创建完成后，创建人只能查看，**不可修改**。

---

## 4. 非功能性需求

- **易用性**：考虑到部分服务人员可能在户外作业，界面需简洁、字号适中，操作流程尽可能线性。
- **性能**：照片上传需进行压缩处理，节省流量并提高上传速度。
- **稳定性**：在弱网环境下（如农田现场），提交需有加载提示，防止重复提交。
- **数据安全**：客户隐私信息（电话、地址）需加密传输。

---

## 5. 待确认事项 (建议与客户沟通)
1. **自动识别技术**：产品型号的“自动识别”通常涉及OCR技术，是否接入第三方（如百度AI、阿里OCR）？这可能会产生额外API调用费用。

---
